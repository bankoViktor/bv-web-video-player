/*! bv-web-video-player v0.4.3 | (c) Banko Viktor (bankviktor14@gmail.com) | MIT license */
class HTMLBvVideoPlayer extends HTMLElement{constructor(){super(),this._src=null,this._playSpeedDef=3,this._playSpeedCur=this._playSpeedDef,this._playSpeeds=[.25,.5,.75,1,1.25,1.5,2,4,8],this._moveTimeStep=5,this._volumeStep=.1,this._volumePressed=!1,this._param="q",this._curParValue=null,this._hotkey=!1,this._speedControls=!1;this._moveTimerCount=4,window.addEventListener("keyup",t=>{if(this._hotkey&&t.target===document.body){switch(t.keyCode){case KeyEvent.DOM_VK_F:this._fullscrButton.click();break;case KeyEvent.DOM_VK_SPACE:case KeyEvent.DOM_VK_K:this._video.paused?this._playButton.click():1!=this._video.playbackRate?(this._video.playbackRate=1,this._setSpeed(this._video,this._playSpeedDef)):this._playButton.click();break;case KeyEvent.DOM_VK_LEFT:this._video.currentTime=Math.max(this._video.currentTime-this._moveTimeStep,0);break;case KeyEvent.DOM_VK_H:this._video.paused||this._playButton.click(),this._video.currentTime=Math.max(this._video.currentTime-.04,0);break;case KeyEvent.DOM_VK_RIGHT:this._video.currentTime=Math.min(this._video.currentTime+this._moveTimeStep,this._video.duration);break;case KeyEvent.DOM_VK_SEMICOLON:this._video.paused||this._playButton.click(),this._video.currentTime=Math.min(this._video.currentTime+.04,this._video.duration);break;case KeyEvent.DOM_VK_I:this._pipButton.click();break;case KeyEvent.DOM_VK_J:this._slowerButton.click();break;case KeyEvent.DOM_VK_L:this._fasterButton.click();break;case KeyEvent.DOM_VK_M:this._volumeButton.click(),0==this._video.volume&&(this._video.muted=!1,this._video.volume=1);break;case KeyEvent.DOM_VK_UP:this._video.volume=Math.min(Math.floor(100*this._video.volume)/100+this._volumeStep,1),this._video.muted&&(this._video.muted=!1),t.preventDefault();break;case KeyEvent.DOM_VK_DOWN:this._video.volume=Math.max(Math.floor(100*this._video.volume)/100-this._volumeStep,0),this._video.muted&&(this._video.muted=!1),t.preventDefault()}if(t.keyCode>=KeyEvent.DOM_VK_0&&t.keyCode<=KeyEvent.DOM_VK_9||t.keyCode>=KeyEvent.DOM_VK_NUMPAD0&&t.keyCode<=KeyEvent.DOM_VK_NUMPAD9){const e=t.keyCode<96?48:96,i=(t.keyCode-e)/10;this._video.currentTime=this._video.duration*i}}}),window.addEventListener("keydown",t=>{t.target!==document.body||t.keyCode!==KeyEvent.DOM_VK_SPACE&&t.keyCode!==KeyEvent.DOM_VK_UP&&t.keyCode!==KeyEvent.DOM_VK_DOWN&&t.keyCode!==KeyEvent.DOM_VK_LEFT&&t.keyCode!==KeyEvent.DOM_VK_RIGHT||t.preventDefault()}),this.addEventListener("fullscreenchange",()=>{this._updateFullScreenButtonState()}),this.addEventListener("dblclick",t=>{t.path[0]===this._video&&this._fullscrButton.click()}),this.addEventListener("click",t=>{let e=!0;for(let i=0;i<t.path.length;i++)if(t.path[i]===this._settingsButton){e=!1;break}e&&this._showMenu(!1)}),this.addEventListener("addquality",t=>{const e=t.detail,i=this._createMenuItem(e.innerHTML,e.value);this._menuItemList.appendChild(i),null===this._curParValue&&i.click()}),this.addEventListener("mousemove",()=>{this._moveTimerCount=4,this._panelBotton.classList.remove("hided"),this._gradientBotton.classList.remove("hided"),document.fullscreenElement&&(this.style.cursor="")}),this._moveTimerId=setInterval(()=>{this._video.paused||(this._moveTimerCount>0?this._moveTimerCount-=1:null!=this._moveTimerCount&&(this._moveTimerCount=null,this._panelBotton.classList.add("hided"),this._gradientBotton.classList.add("hided"),document.fullscreenElement&&(this.style.cursor="none")))},1e3),this.append("Технология WebComponents не поддерживается вашим браузером. Обновите браузер.");const t=this.attachShadow({mode:"open"}),e=this._createStyle(),i=document.createElement("div");i.classList.add("wrapper"),this._settingMenu=this._createSettingsMenu(),this._panelBotton=this._createBottomPanel(),this._gradientBotton=document.createElement("div"),this._gradientBotton.classList.add("gradient-bottom","fade"),this._video=document.createElement("video"),this._video.innerHTML="Тег video не поддерживается вашим браузером. Обновите браузер.",this._video.addEventListener("timeupdate",t=>{const e=t.currentTarget,i=e.currentTime/e.duration;this._progressPos.style.width=100*i+"%",this._updateTime()}),this._video.addEventListener("play",()=>{this._updatePlayButtonState()}),this._video.addEventListener("pause",()=>{this._updatePlayButtonState()}),this._video.addEventListener("volumechange",t=>{this._updateVolumeButtonState();const e=t.currentTarget;this._volumeSliderFill.style.width=100*e.volume+"%"}),this._video.addEventListener("ratechange",()=>{this._updateSpeedControls()}),this._video.addEventListener("enterpictureinpicture",()=>{this._updatePipButtonState(!0)}),this._video.addEventListener("leavepictureinpicture",()=>{this._updatePipButtonState(!1)}),this._video.addEventListener("click",()=>{"1"!==this._settingMenu.style.opacity&&this._playButton.click()}),this._video.addEventListener("durationchange",()=>{this._updateTime()}),this._video.addEventListener("progress",t=>{const e=t.currentTarget,i=e.buffered;this._buffersSegsList.innerHTML="";for(let t=0;t<i.length;t++){const s=i.start(t),o=i.end(t),n=s/e.duration,r=o/e.duration-n,a=document.createElement("li");a.style.left=100*n+"%",a.style.width=100*r+"%",this._buffersSegsList.appendChild(a)}}),i.appendChild(this._settingMenu),i.appendChild(this._panelBotton),i.appendChild(this._gradientBotton),i.appendChild(this._video),t.appendChild(e),t.appendChild(i),this._updatePlayButtonState(),this._updateVolumeButtonState(),this._updateSpeedControls(),this._updatePipButtonState(),this._updateFullScreenButtonState()}_updateTime(){const t=this._video.currentTime,e=this._video.duration;if(isNaN(t)||isNaN(e))this._timeIndicator.style.visibility="collapse";else{this._timeIndicator.style.visibility="visible";const i=HTMLBvVideoPlayer._dur2str(t),s=HTMLBvVideoPlayer._dur2str(e);this._timeIndicator.textContent=`${i} / ${s}`}}static get observedAttributes(){return["src","param","speed-controls","hotkey"]}attributeChangedCallback(t,e,i){if(e!==i)switch(null===i&&(i="false"),t){case"src":this._src=i,this._video.src=i;break;case"param":this._param=i;break;case"speed-controls":this._speedControls="false"!==i.toLowerCase(),this._updateSpeedButtonState();break;case"hotkey":this._hotkey="false"!==i.toLowerCase()}}get source(){return this._src}set source(t){this.setAttribute("src",t)}get param(){return this._param}set param(t){this.setAttribute("param",t)}get speedcontrols(){return this._speedControls}set speedcontrols(t){this.setAttribute("speed-controls",t)}get hotkey(){return this._hotkey}set hotkey(t){this.setAttribute("hotkey",t)}connectedCallback(){this._updateSpeedButtonState()}disconnectedCallback(){clearInterval(this._moveTimerId),this._moveTimerId=0}_updateSpeedButtonState(){this._slowerButton.disabled=!this._speedControls,this._slowerButton.hidden=!this._speedControls,this._speedIndicatorContent.hidden=!this._speedControls,this._fasterButton.hidden=!this._speedControls,this._fasterButton.disabled=!this._speedControls}_createStyle(){const t=document.createElement("style");return t.textContent=".wrapper{--button-size:40px;--volume-width:70px;--volume-thumb:12px;--controls-color:rgba(255, 255, 255, 0.9);--progress-color:rgba(255, 255, 255, 0.2);--progress-buffered-color:rgba(255, 255, 255, 0.3);--progress-cursor-color:rgba(255, 255, 255, 0.4);--progress-time-color:red;height:100%;width:100%;background-color:#000;position:relative;user-select:none;min-width:500px;min-height:100px;font-family:Arial}.wrapper video{height:100%;width:100%}.panel-bottom,.panel-top{position:absolute;width:100%;z-index:30000}.panel-top{top:0}.panel-bottom{bottom:0}.fade{transition:visibility .15s,opacity .15s linear}.hided{visibility:collapse;opacity:0}.panel-wrapper{margin:0 10px}.gradient-bottom,.gradient-top{position:absolute;left:0;width:100%;height:150px}.gradient-top{top:0;background:linear-gradient(180deg,rgba(0,0,0,.7) 0,rgba(0,0,0,0) 70%)}.gradient-bottom{bottom:0;background:linear-gradient(0deg,rgba(0,0,0,.7) 0,rgba(0,0,0,0) 90%)}.progress-container{height:8px;margin-bottom:4px}.progress-track{position:relative;background-color:var(--progress-color);height:50%;transform:translateY(+50%)}.progress-track:hover{height:100%;transform:translateY(0);cursor:pointer}.progress-cursor,.progress-pos{position:absolute;height:100%;width:0%}.progress-pos{background-color:var(--progress-time-color)}.progress-cursor{background-color:var(--progress-cursor-color)}.segments{position:absolute;height:100%;width:100%}.segments ul{list-style-type:none}.segments ul li{position:absolute;top:0;height:100%;user-select:none}.buffers ul li{background-color:var(--progress-buffered-color)}.ctl{font-size:0;display:inline-block;height:100%}.ctl-left{float:left}.ctl-right{float:right}.controls-container button{height:var(--button-size);width:var(--button-size);background-color:transparent;border:0 solid transparent;cursor:pointer;padding:0;outline:0;vertical-align:middle}.controls-container button path{fill:var(--controls-color)}.controls-container button:hover{background-color:rgba(255,255,255,.1)}.controls-container button:active{background-color:rgba(255,255,255,.2);border-color:#fff}.controls-container button:active:focus{border-color:transparent}.controls-container button:disabled path{fill:rgba(255,255,255,.3)}.controls-container button:disabled:hover{background-color:transparent}.controls-container button:disabled:active{border-color:transparent}.volume-container{display:inline-block;width:var(--button-size);height:var(--button-size);transition:width .4s;white-space:nowrap;overflow:hidden;vertical-align:middle}.volume-container:hover{width:calc(var(--button-size) + var(--volume-width));transition:width .4s}.volume-slider{display:inline-block;width:var(--volume-width);vertical-align:middle;cursor:pointer;position:relative;height:100%}.volume-slider-wrapper{position:relative;height:100%;margin:0 calc(var(--volume-thumb))}.volume-slider-track{position:absolute;top:50%;transform:translateY(-50%);left:0;height:3px;width:100%;background-color:rgba(0,0,0,.3)}.volume-slider-fill{background-color:var(--controls-color);position:absolute;left:0;top:0;height:100%;width:100%}.volume-slider-thumb{position:absolute;top:50%;transform:translateY(-50%) translateX(50%);right:0;background-color:var(--controls-color);height:var(--volume-thumb);width:var(--volume-thumb);border-radius:calc(var(--volume-thumb)/ 2);cursor:pointer}.ctl-speed-indicator{width:60px!important}.ctl-speed-indicator-content{font-size:18px;font-weight:bolder;border-radius:4px;padding:3px 0;color:var(--controls-color)}.time-indicator{margin-left:10px;font-size:1.1rem;font-weight:400;display:inline-block;vertical-align:middle;color:var(--controls-color)}.menu{position:absolute;right:10px;bottom:60px;width:250px;background-color:rgba(28,28,28,.9);color:#eee;border-radius:2px;z-index:3001;visibility:collapse;opacity:0;transition:.3s opacity,.3s visibility;text-shadow:0 0 2px rgb(0,0,0,.5)}.menu ul{padding:0;margin:0;list-style:none}.menu li{display:block;cursor:pointer;font-size:1rem;padding:10px 5px}.menu li:hover{background-color:rgba(255,255,255,.1)}.menu-item-icon{float:left;padding:0 10px}.menu-item-icon svg{fill:#eee;width:16px}.menu-item-body{height:100%}.hide{visibility:hidden}.timecode-container{margin-bottom:8px}.timecode{margin-left:0;width:55px;background-color:rgba(0,0,0,.3);font-size:1rem;text-align:center;padding:2px 5px;position:relative;color:var(--controls-color);border-radius:2px}",t}_createSettingsMenu(){this._menuItemList=document.createElement("ul");const t=document.createElement("div");return t.classList.add("menu"),t.appendChild(this._menuItemList),t}_createMenuItem(t,e){const i=document.createElement("div");i.classList.add("menu-item-icon"),i.style.visibility="hidden",i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 172 172"><path d="M145.43294,37.93294l-80.93294,80.93295l-30.76628,-30.76628l-10.13411,10.13411l40.90039,40.90039l91.06706,-91.06705z"></path></svg>';const s=document.createElement("div");s.classList.add("menu-item-body"),s.innerHTML=t;const o=document.createElement("li");return o.setAttribute("data-value",e),o.addEventListener("click",t=>{this._showMenu(!1);const e=t.currentTarget.getAttribute("data-value");if(this._curParValue===e)return;this._curParValue=e,this._updateMenu();const i=this._video.currentTime,s=this._video.paused;this._video.src=`${this._src}?${this._param}=${this._curParValue}`,this._video.currentTime=i,s||this._video.play()}),o.appendChild(i),o.appendChild(s),o}_updateMenu(){Array.from(this._menuItemList.children).forEach((t,e,i)=>{const s=this._curParValue===t.getAttribute("data-value");t.querySelector(".menu-item-icon").style.visibility=s?"visible":"hidden"})}_showMenu(t=!0){this._settingMenu.style.visibility=t?"visible":"collapse",this._settingMenu.style.opacity=t?"1":"0"}_createBottomPanel(){const t=document.createElement("div");t.classList.add("panel-bottom","fade");const e=document.createElement("div");e.classList.add("panel-wrapper");const i=this._createTimeCodeContainer(),s=this._createProgressContainer(),o=this._createControlsContainer();return e.appendChild(i),e.appendChild(s),e.appendChild(o),t.appendChild(e),t}_createTimeCodeContainer(){const t=document.createElement("div");return t.classList.add("timecode-container"),this._timeCode=document.createElement("div"),this._timeCode.classList.add("timecode"),this._timeCode.hidden=!0,t.appendChild(this._timeCode),t}_createProgressContainer(){const t=document.createElement("div");t.classList.add("progress-container");const e=document.createElement("div");e.classList.add("progress-track"),e.addEventListener("mousemove",t=>{const e=t.target.offsetLeft+t.offsetX,i=t.currentTarget.clientWidth,s=e/i;this._progressCursor.style.width=100*s+"%",this._timeCode.removeAttribute("hidden");const o=this._timeCode.clientWidth;let n=e-o/2;e<o/2?n=0:e>i-o/2&&(n=i-o),this._timeCode.style.marginLeft=n+"px";const r=this._video.duration*s;this._timeCode.innerText=HTMLBvVideoPlayer._dur2str(r)}),e.addEventListener("mouseleave",()=>{this._progressCursor.style.width="0%",this._timeCode.setAttribute("hidden","")}),e.addEventListener("click",t=>{const e=t.target.offsetLeft+t.offsetX,i=t.currentTarget.clientWidth;this._video.currentTime=this._video.duration*(e/i)}),this._buffersSegsList=document.createElement("ul");const i=document.createElement("div");return i.classList.add("segments","buffers"),i.appendChild(this._buffersSegsList),this._progressCursor=document.createElement("div"),this._progressCursor.classList.add("progress-cursor"),this._progressPos=document.createElement("div"),this._progressPos.classList.add("progress-pos"),e.appendChild(i),e.appendChild(this._progressCursor),e.appendChild(this._progressPos),t.appendChild(e),t}_createControlsContainer(){const t=document.createElement("div");t.classList.add("controls-container");const e=this._createControlsLeftSide(),i=this._createControlsRightSide();return t.appendChild(e),t.appendChild(i),t}_createControlsLeftSide(){const t=document.createElement("div");t.classList.add("ctl","ctl-left"),this._playButton=document.createElement("button"),this._playButton.addEventListener("click",t=>{this._video.paused?this._video.play():this._video.pause()});const e=this._createVolumeControl();return this._timeIndicator=document.createElement("div"),this._timeIndicator.classList.add("time-indicator"),this._timeIndicator.style.visibility="collapse",t.appendChild(this._playButton),t.appendChild(e),t.appendChild(this._timeIndicator),t}_createVolumeControl(){const t=document.createElement("div");t.classList.add("volume-container"),this._volumeButton=document.createElement("button"),this._volumeButton.addEventListener("click",()=>{this._video.muted=!this._video.muted,0===this._video.volume&&(this._video.muted=!1,this._video.volume=1)}),this._volumeSliderThumb=document.createElement("div"),this._volumeSliderThumb.classList.add("volume-slider-thumb"),this._volumeSliderFill=document.createElement("div"),this._volumeSliderFill.classList.add("volume-slider-fill"),this._volumeSliderFill.appendChild(this._volumeSliderThumb);const e=document.createElement("div");e.classList.add("volume-slider-track"),e.appendChild(this._volumeSliderFill);const i=document.createElement("div");i.classList.add("volume-slider-wrapper"),i.addEventListener("mousemove",t=>{this._volumePressed&&this._setVolume(t)}),i.addEventListener("mousedown",t=>{this._setVolume(t)}),i.appendChild(e);const s=document.createElement("div");return s.classList.add("volume-slider"),s.title="Громкость",s.addEventListener("mousedown",()=>{this._volumePressed=!0}),s.addEventListener("mouseup",()=>{this._volumePressed=!1}),s.addEventListener("mouseleave",()=>{this._volumePressed=!1}),s.appendChild(i),t.appendChild(this._volumeButton),t.appendChild(s),t}_createControlsRightSide(){const t=document.createElement("div");return t.classList.add("ctl","ctl-right"),this._slowerButton=document.createElement("button"),this._slowerButton.innerHTML='<svg viewBox="0 0 36 36"><g transform-origin="50%" transform="scale(0.9)"><path d="M 28.5,26 15.5,18 28.5,10 z M 18.5,26 5.5,18 18.5,10 z"></path></g></svg>',this._slowerButton.title="Уменьшить скорость воспроизведения"+this._hotkeyPrint(this._slowerButton),this._slowerButton.addEventListener("click",t=>{t.target.disabled||this._setSpeed(this._video,this._playSpeedCur-1)}),this._speedIndicatorContent=document.createElement("div"),this._speedIndicatorContent.classList.add("ctl-speed-indicator-content"),this._speedIndicatorButton=document.createElement("button"),this._speedIndicatorButton.classList.add("ctl-speed-indicator"),this._speedIndicatorButton.addEventListener("click",t=>{this._setSpeed(this._video,this._playSpeedDef)}),this._speedIndicatorButton.appendChild(this._speedIndicatorContent),this._fasterButton=document.createElement("button"),this._fasterButton.innerHTML='<svg viewBox="0 0 36 36"><g transform-origin="50%" transform="scale(0.9)"><path d="M 7.5,26 20.5,18 7.5,10 z M 17.5,26 30.5,18 17.5,10 z"></path></g></svg>',this._fasterButton.title="Увеличить скорость воспроизведения"+this._hotkeyPrint(this._fasterButton),this._fasterButton.addEventListener("click",t=>{t.target.disabled||this._setSpeed(this._video,this._playSpeedCur+1)}),this._settingsButton=document.createElement("button"),this._settingsButton.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 172 172"><g transform-origin="50%" transform="scale(0.65)"><path d="M69.28711,14.33333l-3.52734,18.08464c-5.8821,2.22427 -11.32102,5.33176 -16.097,9.25228l-17.37077,-5.99089l-16.71289,28.97461l13.89941,12.07975c-0.49282,3.02401 -0.81185,6.10305 -0.81185,9.26628c0,3.16323 0.31903,6.24227 0.81185,9.26628l-13.89941,12.07975l16.71289,28.9746l17.37077,-5.99088c4.77599,3.92052 10.2149,7.02801 16.097,9.25227l3.52734,18.08464h33.42578l3.52735,-18.08464c5.88211,-2.22427 11.32102,-5.33176 16.097,-9.25227l17.37077,5.99088l16.71289,-28.9746l-13.89941,-12.07975c0.49282,-3.02401 0.81185,-6.10305 0.81185,-9.26628c0,-3.16323 -0.31902,-6.24227 -0.81185,-9.26628l13.89941,-12.07975l-16.71289,-28.97461l-17.37077,5.99089c-4.77598,-3.92052 -10.21489,-7.02801 -16.097,-9.25228l-3.52735,-18.08464zM86,57.33333c15.83117,0 28.66667,12.8355 28.66667,28.66667c0,15.83117 -12.8355,28.66667 -28.66667,28.66667c-15.83117,0 -28.66667,-12.8355 -28.66667,-28.66667c0,-15.83117 12.8355,-28.66667 28.66667,-28.66667z"></path></g></svg>',this._settingsButton.title="Настройки",this._settingsButton.addEventListener("click",()=>{const t="1"!==this._settingMenu.style.opacity;this._showMenu(t)}),this._pipButton=document.createElement("button"),this._pipButton.addEventListener("click",()=>{document.pictureInPictureElement?document.exitPictureInPicture():this._video.requestPictureInPicture()}),this._fullscrButton=document.createElement("button"),this._fullscrButton.addEventListener("click",()=>{document.fullscreen?document.exitFullscreen():this.requestFullscreen()}),t.appendChild(this._slowerButton),t.appendChild(this._speedIndicatorButton),t.appendChild(this._fasterButton),t.appendChild(this._settingsButton),t.appendChild(this._pipButton),t.appendChild(this._fullscrButton),t}_hotkeyPrint(t){if(!this._hotkey)return"";let e;switch(t){case this._fasterButton:e="L";break;case this._playButton:e="K";break;case this._slowerButton:e="J";break;case this._volumeButton:e="M";break;case this._pipButton:e="I";break;case this._fullscrButton:e="F"}return` (${e})`}_updatePlayButtonState(){this._video.paused?HTMLBvVideoPlayer._changeButtonState(this._playButton,"Смотреть"+this._hotkeyPrint(this._playButton),"<svg viewBox='0 0 36 36'><path d='M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z'/></svg>"):HTMLBvVideoPlayer._changeButtonState(this._playButton,"Пауза"+this._hotkeyPrint(this._playButton),"<svg viewBox='0 0 36 36'><path d='M 12,26 16,26 16,10 12,10 z M 21,26 25,26 25,10 21,10 z'/></svg>")}_updateVolumeButtonState(){this._video.muted||0===this._video.volume?HTMLBvVideoPlayer._changeButtonState(this._volumeButton,"Включение звука"+this._hotkeyPrint(this._volumeButton),"<svg viewBox='0 0 36 36'><path d='m 21.48,17.98 c 0,-1.77 -1.02,-3.29 -2.5,-4.03 v 2.21 l 2.45,2.45 c .03,-0.2 .05,-0.41 .05,-0.63 z m 2.5,0 c 0,.94 -0.2,1.82 -0.54,2.64 l 1.51,1.51 c .66,-1.24 1.03,-2.65 1.03,-4.15 0,-4.28 -2.99,-7.86 -7,-8.76 v 2.05 c 2.89,.86 5,3.54 5,6.71 z M 9.25,8.98 l -1.27,1.26 4.72,4.73 H 7.98 v 6 H 11.98 l 5,5 v -6.73 l 4.25,4.25 c -0.67,.52 -1.42,.93 -2.25,1.18 v 2.06 c 1.38,-0.31 2.63,-0.95 3.69,-1.81 l 2.04,2.05 1.27,-1.27 -9,-9 -7.72,-7.72 z m 7.72,.99 -2.09,2.08 2.09,2.09 V 9.98 z'/></svg>"):this._video.volume<.5?HTMLBvVideoPlayer._changeButtonState(this._volumeButton,"Отключение звука"+this._hotkeyPrint(this._volumeButton),"<svg viewBox='0 0 36 36'><path d='M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 Z'></path></svg >"):HTMLBvVideoPlayer._changeButtonState(this._volumeButton,"Отключение звука"+this._hotkeyPrint(this._volumeButton),"<svg viewBox='0 0 36 36'><path d='M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 ZM19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z'/></svg>"),this._volumeSliderFill.style.width=100*this._video.volume+"%"}_updatePipButtonState(t=!1){t?HTMLBvVideoPlayer._changeButtonState(this._pipButton,"Закрыть мини проигрыватель"+this._hotkeyPrint(this._pipButton),"<svg viewBox='0 0 36 36'><path d='M11,13 V23 H25 V13 z M29,25 L29,10.98 C29,9.88 28.1,9 27,9 L9,9 C7.9,9 7,9.88 7,10.98 L7,25 C7,26.1 7.9,27 9,27 L27,27 C28.1,27 29,26.1 29,25 L29,25 z M27,25.02 L9,25.02 L9,10.97 L27,10.97 L27,25.02 L27,25.02 z'/></svg>"):HTMLBvVideoPlayer._changeButtonState(this._pipButton,"Открыть мини проигрыватель"+this._hotkeyPrint(this._pipButton),"<svg viewBox='0 0 36 36'><path d='M25,17 L17,17 L17,23 L25,23 L25,17 L25,17 z M29,25 L29,10.98 C29,9.88 28.1,9 27,9 L9,9 C7.9,9 7,9.88 7,10.98 L7,25 C7,26.1 7.9,27 9,27 L27,27 C28.1,27 29,26.1 29,25 L29,25 z M27,25.02 L9,25.02 L9,10.97 L27,10.97 L27,25.02 L27,25.02 z'/></svg>")}_updateSpeedControls(){this._slowerButton.disabled=this._playSpeedCur<=0,this._fasterButton.disabled=this._playSpeedCur>=this._playSpeeds.length-1,this._speedIndicatorButton.disabled=this._playSpeedCur==this._playSpeedDef,this._speedIndicatorContent.title=this._playSpeedCur==this._playSpeedDef?"Текущая скорость воспроизведения":"К нормальной скорости воспроизведения"+this._hotkeyPrint(this._playButton),this._speedIndicatorContent.innerText="x"+this._video.playbackRate}_updateFullScreenButtonState(){document.fullscreen?HTMLBvVideoPlayer._changeButtonState(this._fullscrButton,"Выход из полноэкранного режима"+this._hotkeyPrint(this._fullscrButton),"<svg viewBox='0 0 36 36'><path d='m 14,14 -4,0 0,2 6,0 0,-6 -2,0 0,4 0,0 z'/><path d='m 22,14 0,-4 -2,0 0,6 6,0 0,-2 -4,0 0,0 z'/><path d='m 20,26 2,0 0,-4 4,0 0,-2 -6,0 0,6 0,0 z'/><path d='m 10,22 4,0 0,4 2,0 0,-6 -6,0 0,2 0,0 z'/></svg>"):HTMLBvVideoPlayer._changeButtonState(this._fullscrButton,"Во весь экран"+this._hotkeyPrint(this._fullscrButton),"<svg viewBox='0 0 36 36'><path d='m 10,16 2,0 0,-4 4,0 0,-2 L 10,10 l 0,6 0,0 z'/><path d='m 20,10 0,2 4,0 0,4 2,0 L 26,10 l -6,0 0,0 z'/><path d='m 24,24 -4,0 0,2 L 26,26 l 0,-6 -2,0 0,4 0,0 z'/><path d='M 12,20 10,20 10,26 l 6,0 0,-2 -4,0 0,-4 0,0 z'/></svg>")}static _str2dur(t){let e=t.split(":",3).reverse(),i=0,s=[1,60,3600];for(let t=0;t<e.length;t++)i+=parseInt(e[t])*s[t];return i}static _dur2str(t){let e=Math.trunc(t/60),i=Math.trunc(e/60),s=Math.trunc(t-60*(60*i+e)),o=e+":"+(s<10?"0"+s:s);return e>=60&&(o=i+":"+o),o}static _changeButtonState(t,e,i){t.title=e,t.innerHTML=i}_setSpeed(t,e){this._playSpeedCur=e,t.playbackRate=this._playSpeeds[e]}_setVolume(t){let e=t.offsetX;t.target===this._volumeSliderThumb&&(e=t.target.offsetLeft+t.offsetX+6);let i=e/(t.currentTarget.clientWidth-1);i<0?i=0:i>1&&(i=1),this._video.volume=i,this._volumeSliderFill.style.width=`${100*i}%`,this._video.muted&&(this._video.muted=!1)}}class HTMLBvQuality extends HTMLElement{constructor(){super(),this._value=null}static get observedAttributes(){return["value"]}get value(){return this._value}set value(t){this.setAttribute("value",t)}attributeChangedCallback(t,e,i){if(e!==i)switch(t){case"value":this._value=i}}connectedCallback(){const t=this.parentElement;if(null===t||"BV-VIDEO-PLAYER"!==t.nodeName)return void console.error("Тег 'bv-quality' должен находиться внутри элемента 'bv-video-player'.");const e=new CustomEvent("addquality",{detail:this});t.dispatchEvent(e)}}if(window.customElements.define("bv-video-player",HTMLBvVideoPlayer),window.customElements.define("bv-quality",HTMLBvQuality),void 0===KeyEvent)var KeyEvent={DOM_VK_SPACE:32,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_0:48,DOM_VK_9:57,DOM_VK_F:70,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD9:105,DOM_VK_SEMICOLON:186};